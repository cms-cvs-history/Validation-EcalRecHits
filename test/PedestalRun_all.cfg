process EcalHitsValid  = 
	{
  untracked PSet maxEvents = {untracked int32 input = 10}


  service = RandomNumberGeneratorService
  {
     untracked uint32 sourceSeed = 98765
      PSet moduleSeeds = 
      {
         untracked uint32 g4SimHits = 9876
         untracked uint32 ecalUnsuppressedDigis = 12345
      }
  }
  module randomEngineStateProducer = RandomEngineStateProducer { }	

  # create empty events using a neutrino gun
  #
  source = FlatRandomEGunSource
  {
     untracked PSet PGunParameters =
     {
        # you can request more than 1 particle
        untracked vint32 PartID = {14}
        untracked double MinEta = -3.0
        untracked double MaxEta =  3.0
        untracked double MinPhi = -3.14159265358979323846 # in radians
        untracked double MaxPhi =  3.14159265358979323846
        untracked double MinE   =  9.99
        untracked double MaxE   = 10.01
     }
     untracked int32 Verbosity = 0 # set to 1 (or greater)  for printouts
  }
    
  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"   

  # initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # geometry (Only Ecal)
  include "Geometry/EcalCommonData/data/EcalOnly.cfi"

  module USER = PoolOutputModule { 
         untracked string fileName = "PedestalRun_all_EcalValidation.root"      
  }
                                                                                
  # DQM services
  service = DaqMonitorROOTBackEnd{ }

  service = Timing{ }
  
  service = SimpleMemoryCheck{ }

  include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"

  # run simulation, with EcalHits Validation specific watcher 
  include "SimG4Core/Application/data/g4SimHits.cfi"
  replace g4SimHits.Generator.HepMCProductLabel = "source"		

  # Mixing Module
  include "SimGeneral/MixingModule/data/mixNoPU.cfi"

  # ECAL unsuppressed digis validation sequence

  # Reconstruction geometry service
  include "Geometry/CaloEventSetup/data/CaloGeometry.cff"

  # use trivial ESProducer for tests
  include "CalibCalorimetry/EcalTrivialCondModules/data/EcalTrivialCondRetriever.cfi"

  include "SimCalorimetry/EcalSimProducers/data/ecaldigi.cfi"

  # ECAL digis validation sequence
  include "Validation/EcalDigis/data/ecalUnsuppressedDigisValidationSequence.cff"

  # ECAL LocalReco sequence 
  include "CalibCalorimetry/EcalLaserCorrection/data/ecalLaserCorrectionService.cfi"
  include "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
  replace ecalWeightUncalibRecHit.EBdigiCollection = ecalUnsuppressedDigis
  replace ecalWeightUncalibRecHit.EEdigiCollection = ecalUnsuppressedDigis
  include "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
  include "RecoLocalCalo/EcalRecProducers/data/ecalPreshowerRecHit.cfi"
  replace ecalPreshowerRecHit.ESdigiCollection = ecalUnsuppressedDigis
  
  sequence ecalUnsuppressedLocalRecoSequence = { ecalWeightUncalibRecHit, ecalRecHit , ecalPreshowerRecHit }

  # ECAL rechits validation sequence
  include "Validation/EcalRecHits/data/ecalUnsuppressedRecHitsValidationSequence.cff"

  sequence digis = { ecalUnsuppressedDigis , randomEngineStateProducer, ecalUnsuppressedDigisValidationSequence }
  sequence rechits = { ecalUnsuppressedLocalRecoSequence , ecalUnsuppressedRecHitsValidationSequence }

  path p1 = { g4SimHits , mix , digis , rechits }
  endpath outpath = { USER }

  }		
